<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cat.rufull.domain.mapper.managerlog.ManagerLogMapper">

    <cache/>

    <resultMap id="ManagerLogResult" type="com.cat.rufull.domain.model.ManageLog">
        <id column="id" property="id"/>
        <result column="detail" property="detail"/>
        <result column="created_time" property="createTime"/>
        <!--与管理员关联-->
        <association property="manager" javaType="com.cat.rufull.domain.model.Manager">
            <id column="manager_id" property="id"></id>
            <result column="managername" property="username"></result>
        </association>
        <!--与用户关联-->
        <association property="account" javaType="com.cat.rufull.domain.model.Account">
            <id column="account_id" property="id"></id>
            <result column="accountname" property="username"></result>
        </association>
    </resultMap>


    <select id="findAllLog" resultMap="ManagerLogResult">
        SELECT
        manage_log.id,
        manage_log.detail,
        manage_log.created_time,
        account.username as accountname,
        manager.username as managername
        FROM
        manage_log,account,manager where
             manage_log.manager_id = manager.id and
             manage_log.account_id = account.id

    </select>

    <select id="findAllmLog" resultMap="ManagerLogResult">
        SELECT
        manage_log.id,
        manage_log.detail,
        manage_log.created_time,
        manager.username as managername
        FROM
        manage_log,account,manager where
        manage_log.manager_id = manager.id

    </select>

    <insert id="addLog" >
        INSERT into manage_log(detail,created_time,account_id,manager_id)
        VALUES(#{detail},#{createdTime},#{account.id},#{manager.id})
    </insert>

</mapper>